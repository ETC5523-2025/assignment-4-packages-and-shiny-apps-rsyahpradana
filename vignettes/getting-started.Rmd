---
title: "Getting started with a4syahpradana"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting started with a4syahpradana}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
library(a4syahpradana)
library(dplyr)
library(ggplot2)
library(scales)
```

# Overview

The `a4syahpradana` package provides tools to explore the most common
American names. It contains a cleaned dataset (common_names), a helper
function for ranking and summarising names, and a Shiny dashboard for
interactive visualisation.

This vignette walks through the typical workflow, from exploring the
dataset, to ranking and visualising names, and finally launching the
dashboard.

## Loading Dataset

The dataset `common_names` includes first and last names along with
baseline (estimate) and adjusted (final_estimate) population counts.

```{r}
data("common_names")
head(common_names)
```

The total rows and columns are as follow:

```{r}
tibble(rows = nrow(common_names),
       cols = ncol(common_names))
```

## Data Dictionary

The following table describes the variables included in the dataset.

```{r}
tibble::tibble(
  variable = c("first_name","surname","clean_name",
               "adjustment","estimate","final_estimate"),
  type = c("character","character","character",
           "numeric","numeric","numeric"),
  description = c("Given name","Family name",
                  "Standardised full name key",
                  "Adjustment applied to baseline",
                  "Baseline count (people)",
                  "Adjusted count (people)")) |>
  knitr::kable(caption = "Variables in `common_names`")
```

## Ranking the most common names

The function top_ranked_names() summarises the data and returns the top
names based on either baseline or adjusted counts.

Below is the example of displaying the top 10 first names ranked by
final estimate.

```{r}
top10 <- top_ranked_names(type = "first",
                          measure = "final_estimate",
                          n = 10)
top10
```

## Visualising top-ranked name

In order to make the results easier to interpret, we can create a simple
plot.

```{r}
top10 <- top_ranked_names(type = "first",
                          measure = "final_estimate",
                          n = 10) |>
  dplyr::rename(name = 1, count = 2)

ggplot(top10, aes(x = reorder(name, count), y = count)) +
  geom_col(fill = "#2C7FB8") +
  coord_flip() +
  ggplot2::scale_y_continuous(labels = scales::comma) +
  labs(x = NULL, y = "Number of people",
       title = "Top 10 First Names by Final Estimate") +
  theme_minimal(base_size = 13)
```

## Launching the interactive dashboard

For an interactive exploration, launch the built-in Shiny app. It allows
users to filter by first, last, or full names, compare between baseline
and adjusted counts, and visualise rankings dynamically.

```{r, eval=FALSE}
run_names_app()
```
